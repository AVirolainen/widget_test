<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Widget Page</title>

    <script src="https://gcdn.tranzzo.com/widget/payment-widget.js"></script>
</head>
<body>

<div>
    <label>Ключ API: <input type="text" id="apiKey" /></label> По замовчуванню буде RHQXIF26A4VOBOZMO5E77EEF0FX0LLT5KTA6 від проекту RS_Widget<br/>
    <label>Валюта: <input type="text" id="currency" value="XTS" /></label><br/>
    <label>Сума: <input type="number" id="amount" value="1" /></label><br/>
    <button onclick="initWidget()">Ініціювати віджет</button>
</div>

<div id="widget"></div>

<script>
    function initWidget() {
        const apiKey = document.getElementById('apiKey').value || "RHQXIF26A4VOBOZMO5E77EEF0FX0LLT5KTA6";
        const currency = document.getElementById('currency').value;
        const amount = parseFloat(document.getElementById('amount').value);

        function logToVercel(message) {
            fetch("/api/log", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ message }),
            }).catch((error) => console.error("Error sending log:", error));
        }

        logToVercel({apiKey, currency, amount});

        PaymentWidget.init({
            apiKey: apiKey,
            mode: 'embedded',
            selector: '#widget',
            payment: {
                type: 'pay',
                amount: amount,
                currency: currency
            }
        });
    }
</script>

</body>
</html>
